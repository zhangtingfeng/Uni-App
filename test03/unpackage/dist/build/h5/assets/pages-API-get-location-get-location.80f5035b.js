import{_ as t,aV as e,s as i,$ as o,o as n,c as a,w as s,a as u,b as c,m as l,t as p,r,d,e as f,i as m,f as g,v as h}from"./index.fb84ef13.js";import{_}from"./uni-popup.eaaf2eb3.js";import{a as y}from"./util.0c6d2982.js";import"./uni-transition.23c6bd3c.js";var L=y;var S=t({data:()=>({title:"getLocation",hasLocation:!1,location:{},type:""}),methods:{togglePopup(t){this.type=t},showConfirm(){this.type="showpopup"},hideConfirm(){this.type=""},async getLocation(){this.doGetLocation()},doGetLocation(){e({success:t=>{this.hasLocation=!0,this.location=L(t.longitude,t.latitude)},fail:t=>{t.errMsg.indexOf("auth deny")>=0?i({title:"访问位置被拒绝"}):i({title:t.errMsg})}})},getSetting:function(){return new Promise(((t,e)=>{uni.getSetting({success:e=>{void 0!==e.authSetting["scope.userLocation"]?e.authSetting["scope.userLocation"]?t(1):t(2):t(0)}})}))},openSetting:function(){this.hideConfirm(),uni.openSetting({success:t=>{t.authSetting&&t.authSetting["scope.userLocation"]&&this.doGetLocation()},fail:t=>{}})},async checkPermission(){let t=permision.isIOS?await permision.requestIOS("location"):await permision.requestAndroid("android.permission.ACCESS_FINE_LOCATION");return null===t||1===t?t=1:2===t?o({content:"系统定位已关闭",confirmText:"确定",showCancel:!1,success:function(t){}}):t.code?o({content:t.message}):o({content:"需要定位权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),t},clear:function(){this.hasLocation=!1}}},[["render",function(t,e,i,o,y,L){const S=r(f("page-head"),d),C=m,w=g,k=h,x=r(f("uni-popup"),_);return n(),a(C,null,{default:s((()=>[u(S,{title:y.title},null,8,["title"]),u(C,{class:"uni-padding-wrap"},{default:s((()=>[u(C,{style:{background:"#FFFFFF",padding:"40rpx"}},{default:s((()=>[u(C,{class:"uni-hello-text uni-center"},{default:s((()=>[c("当前位置经纬度")])),_:1}),!1===y.hasLocation?(n(),a(C,{key:0,class:"uni-h2 uni-center uni-common-mt"},{default:s((()=>[c("未获取")])),_:1})):l("",!0),!0===y.hasLocation?(n(),a(C,{key:1,class:"uni-h2 uni-center uni-common-mt"},{default:s((()=>[u(w,null,{default:s((()=>[c("E: "+p(y.location.longitude[0])+"°"+p(y.location.longitude[1])+"′",1)])),_:1}),u(w,null,{default:s((()=>[c("\\nN: "+p(y.location.latitude[0])+"°"+p(y.location.latitude[1])+"′",1)])),_:1})])),_:1})):l("",!0)])),_:1}),u(C,{class:"uni-btn-v"},{default:s((()=>[u(k,{type:"primary",onClick:L.getLocation},{default:s((()=>[c("获取位置")])),_:1},8,["onClick"]),u(k,{onClick:L.clear},{default:s((()=>[c("清空")])),_:1},8,["onClick"])])),_:1})])),_:1}),u(x,{show:"showpopup"===y.type,mode:"fixed",onHidePopup:e[1]||(e[1]=t=>L.togglePopup(""))},{default:s((()=>[u(C,{class:"popup-view"},{default:s((()=>[u(w,{class:"popup-title"},{default:s((()=>[c("需要用户授权位置权限")])),_:1}),u(C,{class:"uni-flex popup-buttons"},{default:s((()=>[u(k,{class:"uni-flex-item",type:"primary","open-type":"openSetting",onClick:L.openSetting},{default:s((()=>[c("设置")])),_:1},8,["onClick"]),u(k,{class:"uni-flex-item",onClick:e[0]||(e[0]=t=>L.togglePopup(""))},{default:s((()=>[c("取消")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}],["__scopeId","data-v-5ea2441c"]]);export{S as default};
