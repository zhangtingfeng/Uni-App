import{_ as e,a8 as s,U as a,a9 as t,$ as l,aa as n,ab as i,ac as o,o as c,c as d,w as u,a as r,b as f,t as p,B as m,C as _,F as h,ad as g,ae as b,af as k,f as C,i as v,R as D,I as L,r as w,e as I,v as y,g as V}from"./index.fb84ef13.js";import{_ as x}from"./uni-rate.69d17103.js";import"./uni-icons.3ce326c8.js";var U=e({data:()=>({msgContents:["界面显示错乱","启动缓慢，卡出翔了","UI无法直视，丑哭了","偶发性崩溃"],stars:[1,2,3,4,5],imageList:[],sendDate:{score:0,content:"",contact:""}}),onLoad(){this.deviceInfo={appid:"__UNI__5D0B0CA",imei:plus.device.imei,p:"Android"===plus.os.name?"a":"i",md:plus.device.model,app_version:plus.runtime.version,plus_version:plus.runtime.innerVersion,os:plus.os.version,net:""+plus.networkinfo.getCurrentType()},this.sendDate=Object.assign(this.deviceInfo,this.sendDate)},methods:{close(e){this.imageList.splice(e,1)},chooseMsg(){s({itemList:this.msgContents,success:e=>{this.sendDate.content=this.msgContents[e.tapIndex]}})},chooseImg(){a({sourceType:["camera","album"],sizeType:"compressed",count:5-this.imageList.length,success:e=>{this.imageList=this.imageList.concat(e.tempFilePaths)}})},chooseStar(e){this.sendDate.score=e},previewImage(e){t({urls:this.imageList,current:this.imageList[e]})},send(){if(0===this.sendDate.content.length)return void l({content:"请输入问题和意见",showCancel:!1});n({title:"上传中..."});let e=this.imageList.map(((e,s)=>({name:"images"+s,uri:e})));this.request(this.sendDate,e).then((e=>{"string"==typeof e.data&&(e.data=JSON.parse(e.data)),200===e.statusCode&&e.data&&0===e.data.ret?(l({content:"反馈成功",showCancel:!1}),this.imageList=[],this.sendDate=Object.assign(this.deviceInfo,{score:0,content:"",contact:""})):200!==e.statusCode?l({content:"反馈失败，错误码为："+e.statusCode,showCancel:!1}):l({content:"反馈失败",showCancel:!1})})).catch((e=>{console.log(e)}))},request:(e,s)=>new Promise(((a,t)=>{let l={url:"https://service.dcloud.net.cn/feedback",success:e=>{a(e)},fail:e=>{t(e)},complete(){k()}};s.length>0?(l.files=s,l.formData=e,i(l)):(l.data=e,l.method="POST",o(l))}))}},[["render",function(e,s,a,t,l,n){const i=C,o=v,k=D,U=V,j=L,O=w(I("uni-rate"),x),T=y;return c(),d(o,{class:"page"},{default:u((()=>[r(o,{class:"feedback-title"},{default:u((()=>[r(i,null,{default:u((()=>[f("问题和意见")])),_:1}),r(i,{class:"feedback-quick",onClick:n.chooseMsg},{default:u((()=>[f("快速键入")])),_:1},8,["onClick"])])),_:1}),r(o,{class:"feedback-body"},{default:u((()=>[r(k,{placeholder:"请详细描述你的问题和意见...",modelValue:l.sendDate.content,"onUpdate:modelValue":s[0]||(s[0]=e=>l.sendDate.content=e),class:"feedback-textare"},null,8,["modelValue"])])),_:1}),r(o,{class:"feedback-title"},{default:u((()=>[r(i,null,{default:u((()=>[f("图片(选填,提供问题截图,总大小10M以下)")])),_:1})])),_:1}),r(o,{class:"feedback-body feedback-uploader"},{default:u((()=>[r(o,{class:"uni-uploader"},{default:u((()=>[r(o,{class:"uni-uploader-head"},{default:u((()=>[r(o,{class:"uni-uploader-title"},{default:u((()=>[f("点击预览图片")])),_:1}),r(o,{class:"uni-uploader-info"},{default:u((()=>[f(p(l.imageList.length)+"/5",1)])),_:1})])),_:1}),r(o,{class:"uni-uploader-body"},{default:u((()=>[r(o,{class:"uni-uploader__files"},{default:u((()=>[(c(!0),m(h,null,_(l.imageList,((e,s)=>(c(),d(o,{key:s,class:"uni-uploader__file",style:{position:"relative"}},{default:u((()=>[r(U,{class:"uni-uploader__img",src:e,onClick:e=>n.previewImage(s)},null,8,["src","onClick"]),r(o,{class:"close-view",onClick:e=>n.close(s)},{default:u((()=>[f("x")])),_:2},1032,["onClick"])])),_:2},1024)))),128)),g(r(o,{class:"uni-uploader__input-box"},{default:u((()=>[r(o,{class:"uni-uploader__input",onClick:n.chooseImg},null,8,["onClick"])])),_:1},512),[[b,l.imageList.length<5]])])),_:1})])),_:1})])),_:1})])),_:1}),r(o,{class:"feedback-title"},{default:u((()=>[r(i,null,{default:u((()=>[f("QQ/邮箱")])),_:1})])),_:1}),r(o,{class:"feedback-body"},{default:u((()=>[r(j,{class:"feedback-input",modelValue:l.sendDate.contact,"onUpdate:modelValue":s[1]||(s[1]=e=>l.sendDate.contact=e),placeholder:"(选填,方便我们联系你 )"},null,8,["modelValue"])])),_:1}),r(o,{class:"feedback-title feedback-star-view"},{default:u((()=>[r(i,null,{default:u((()=>[f("应用评分")])),_:1}),r(o,{class:"feedback-star-view"},{default:u((()=>[r(O,{modelValue:l.sendDate.score,"onUpdate:modelValue":s[2]||(s[2]=e=>l.sendDate.score=e),color:"#bbb"},null,8,["modelValue"])])),_:1})])),_:1}),r(T,{type:"default",class:"feedback-submit",onClick:n.send},{default:u((()=>[f("提交")])),_:1},8,["onClick"]),r(o,{class:"feedback-title"},{default:u((()=>[r(i,null,{default:u((()=>[f("用户反馈的结果可在app打包后于DCloud开发者中心查看")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-441433b2"]]);export{U as default};
