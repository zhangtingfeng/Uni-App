import{_ as e,U as s,$ as a,a9 as l,o as t,c as i,w as n,a as u,b as c,t as o,B as d,C as r,F as p,r as f,d as g,e as h,i as _,O as m,K as y,g as I}from"./index.fb84ef13.js";import{p as T}from"./permission.0788b924.js";var x=[["camera"],["album"],["camera","album"]],C=[["compressed"],["original"],["compressed","original"]];var v=e({data:()=>({title:"choose/previewImage",imageList:[],sourceTypeIndex:2,sourceType:["拍照","相册","拍照或相册"],sizeTypeIndex:2,sizeType:["压缩","原图","压缩或原图"],countIndex:8,count:[1,2,3,4,5,6,7,8,9]}),onUnload(){this.imageList=[],this.sourceTypeIndex=2,this.sourceType=["拍照","相册","拍照或相册"],this.sizeTypeIndex=2,this.sizeType=["压缩","原图","压缩或原图"],this.countIndex=8},methods:{sourceTypeChange:function(e){this.sourceTypeIndex=parseInt(e.detail.value)},sizeTypeChange:function(e){this.sizeTypeIndex=parseInt(e.detail.value)},countChange:function(e){this.countIndex=e.detail.value},chooseImage:async function(){if(9===this.imageList.length){let e=await this.isFullImg();if(console.log("是否继续?",e),!e)return}s({sourceType:x[this.sourceTypeIndex],sizeType:C[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:e=>{this.imageList=this.imageList.concat(e.tempFilePaths)},fail:e=>{console.log("err: ",e)}})},isFullImg:function(){return new Promise((e=>{a({content:"已经有9张图片了,是否清空现有图片？",success:s=>{s.confirm?(this.imageList=[],e(!0)):e(!1)},fail:()=>{e(!1)}})}))},previewImage:function(e){var s=e.target.dataset.src;l({current:s,urls:this.imageList})},async checkPermission(e){let s=e?e-1:this.sourceTypeIndex,l=T.isIOS?await T.requestIOS(x[s][0]):await T.requestAndroid(0===s?"android.permission.CAMERA":"android.permission.READ_EXTERNAL_STORAGE");return null===l||1===l?l=1:a({content:"没有开启权限",confirmText:"设置",success:function(e){e.confirm&&T.gotoAppSetting()}}),l}}},[["render",function(e,s,a,l,T,x){const C=f(h("page-head"),g),v=_,z=m,L=I,b=y;return t(),i(v,null,{default:n((()=>[u(C,{title:T.title},null,8,["title"]),u(v,{class:"uni-common-mt"},{default:n((()=>[u(b,null,{default:n((()=>[u(v,{class:"uni-list"},{default:n((()=>[u(v,{class:"uni-list-cell"},{default:n((()=>[u(v,{class:"uni-list-cell-left"},{default:n((()=>[u(v,{class:"uni-label"},{default:n((()=>[c("图片来源")])),_:1})])),_:1}),u(v,{class:"uni-list-cell-right"},{default:n((()=>[u(z,{range:T.sourceType,onChange:x.sourceTypeChange,value:T.sourceTypeIndex,mode:"selector"},{default:n((()=>[u(v,{class:"uni-input"},{default:n((()=>[c(o(T.sourceType[T.sourceTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),u(v,{class:"uni-list-cell"},{default:n((()=>[u(v,{class:"uni-list-cell-left"},{default:n((()=>[u(v,{class:"uni-label"},{default:n((()=>[c("图片质量")])),_:1})])),_:1}),u(v,{class:"uni-list-cell-right"},{default:n((()=>[u(z,{range:T.sizeType,onChange:x.sizeTypeChange,value:T.sizeTypeIndex,mode:"selector"},{default:n((()=>[u(v,{class:"uni-input"},{default:n((()=>[c(o(T.sizeType[T.sizeTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),u(v,{class:"uni-list-cell"},{default:n((()=>[u(v,{class:"uni-list-cell-left"},{default:n((()=>[u(v,{class:"uni-label"},{default:n((()=>[c("数量限制")])),_:1})])),_:1}),u(v,{class:"uni-list-cell-right"},{default:n((()=>[u(z,{range:T.count,onChange:x.countChange,mode:"selector"},{default:n((()=>[u(v,{class:"uni-input"},{default:n((()=>[c(o(T.count[T.countIndex]),1)])),_:1})])),_:1},8,["range","onChange"])])),_:1})])),_:1})])),_:1}),u(v,{class:"uni-list list-pd"},{default:n((()=>[u(v,{class:"uni-list-cell cell-pd"},{default:n((()=>[u(v,{class:"uni-uploader"},{default:n((()=>[u(v,{class:"uni-uploader-head"},{default:n((()=>[u(v,{class:"uni-uploader-title"},{default:n((()=>[c("点击可预览选好的图片")])),_:1}),u(v,{class:"uni-uploader-info"},{default:n((()=>[c(o(T.imageList.length)+"/9",1)])),_:1})])),_:1}),u(v,{class:"uni-uploader-body"},{default:n((()=>[u(v,{class:"uni-uploader__files"},{default:n((()=>[(t(!0),d(p,null,r(T.imageList,((e,s)=>(t(),i(v,{key:s,class:"uni-uploader__file"},{default:n((()=>[u(L,{class:"uni-uploader__img",src:e,"data-src":e,onClick:x.previewImage},null,8,["src","data-src","onClick"])])),_:2},1024)))),128)),u(v,{class:"uni-uploader__input-box"},{default:n((()=>[u(v,{class:"uni-uploader__input",onClick:x.chooseImage},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4d7fe987"]]);export{v as default};
