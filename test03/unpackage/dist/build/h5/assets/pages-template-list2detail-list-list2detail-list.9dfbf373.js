import{_ as t,ac as a,aB as e,as as s,o as i,c as l,w as n,a as o,b as d,t as r,B as u,C as c,F as h,g as _,i as m,r as f,e as p,f as g}from"./index.fb84ef13.js";import{_ as b}from"./uni-load-more.5afad021.js";import{d as v}from"./util.0c6d2982.js";var D=t({data:()=>({banner:{},listData:[],last_id:"",reload:!1,status:"more",adpid:"",contentText:{contentdown:"上拉加载更多",contentrefresh:"加载中",contentnomore:"没有更多"}}),onLoad(){this.adpid=this.$adpid,this.getBanner(),this.getList()},onPullDownRefresh(){this.reload=!0,this.last_id="",this.getBanner(),this.getList()},onReachBottom(){this.status="more",this.getList()},methods:{getBanner(){a({url:"https://unidemo.dcloud.net.cn/api/banner/36kr",data:{column:"id,post_id,title,author_name,cover,published_at"},success:t=>{e(),200==t.statusCode&&(this.banner=t.data)},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},getList(){var t={column:"id,post_id,title,author_name,cover,published_at"};this.last_id&&(this.status="loading",t.minId=this.last_id,t.time=(new Date).getTime()+"",t.pageSize=10),a({url:"https://unidemo.dcloud.net.cn/api/news",data:t,success:t=>{if(200==t.statusCode){let a=this.setTime(t.data);this.listData=this.reload?a:this.listData.concat(a),this.last_id=a[a.length-1].id,this.reload=!1}},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},goDetail:function(t){let a={author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:t.published_at,title:t.title};s({url:"../list2detail-detail/list2detail-detail?detailDate="+encodeURIComponent(JSON.stringify(a))})},setTime:function(t){var a=[];return t.forEach((t=>{a.push({author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:v.format(t.published_at),title:t.title})})),a},aderror(t){console.log("aderror: "+JSON.stringify(t.detail))}}},[["render",function(t,a,e,s,v,D){const x=_,C=m,y=g,B=f(p("uni-load-more"),b);return i(),l(C,null,{default:n((()=>[o(C,{class:"banner",onClick:a[0]||(a[0]=t=>D.goDetail(v.banner))},{default:n((()=>[o(x,{class:"banner-img",src:v.banner.cover},null,8,["src"]),o(C,{class:"banner-title"},{default:n((()=>[d(r(v.banner.title),1)])),_:1})])),_:1}),o(C,{class:"uni-list"},{default:n((()=>[(i(!0),u(h,null,c(v.listData,((t,a)=>(i(),l(C,{key:a,class:"uni-list-cell","hover-class":"uni-list-cell-hover",onClick:a=>D.goDetail(t)},{default:n((()=>[o(C,{class:"uni-media-list"},{default:n((()=>[o(x,{class:"uni-media-list-logo",src:t.cover},null,8,["src"]),o(C,{class:"uni-media-list-body"},{default:n((()=>[o(C,{class:"uni-media-list-text-top"},{default:n((()=>[d(r(t.title),1)])),_:2},1024),o(C,{class:"uni-media-list-text-bottom"},{default:n((()=>[o(y,null,{default:n((()=>[d(r(t.author_name),1)])),_:2},1024),o(y,null,{default:n((()=>[d(r(t.published_at),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),o(B,{status:v.status,"icon-size":16,"content-text":v.contentText},null,8,["status","content-text"])])),_:1})}],["__scopeId","data-v-39e7d5e4"]]);export{D as default};
